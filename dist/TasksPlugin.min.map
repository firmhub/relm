{"version":3,"sources":["webpack:///webpack/universalModuleDefinition?5ca6*****","webpack:///TasksPlugin.min.js","webpack:///./~/lodash/without.js","webpack:///./~/lodash/_arrayIncludesWith.js","webpack:///./~/lodash/_baseDifference.js","webpack:///./~/lodash/_cacheHas.js","webpack:///./src/plugins/TasksPlugin.js"],"names":["root","factory","exports","module","define","amd","this","webpackJsonprelm__name_","146","__webpack_require__","baseDifference","baseRest","isArrayLikeObject","without","array","values","166","arrayIncludesWith","value","comparator","index","length","172","iteratee","includes","arrayIncludes","isCommon","result","valuesLength","arrayMap","baseUnary","LARGE_ARRAY_SIZE","cacheHas","SetCache","outer","computed","valuesIndex","push","196","cache","key","has","312","_toConsumableArray","arr","Array","isArray","i","arr2","from","_toArray","_classCallCheck","instance","Constructor","TypeError","attachTaskAPI","task","handler","instances","isRunning","done","__WEBPACK_IMPORTED_MODULE_0_lodash_without___default","cancel","onCancel","handleAsyncAction","component","type","next","_len2","arguments","overriddenArgs","_key2","child","tail","args","undefined","_type","head","slice","__WEBPACK_IMPORTED_MODULE_1_lodash_get___default","concat","Error","__WEBPACK_IMPORTED_MODULE_0_lodash_without__","n","__WEBPACK_IMPORTED_MODULE_1_lodash_get__","__WEBPACK_IMPORTED_MODULE_2_lodash_isArray__","__WEBPACK_IMPORTED_MODULE_2_lodash_isArray___default","__WEBPACK_IMPORTED_MODULE_3_lodash_mapValues__","__WEBPACK_IMPORTED_MODULE_3_lodash_mapValues___default","d","internals","_createClass","defineProperties","target","props","descriptor","enumerable","configurable","writable","Object","defineProperty","protoProps","staticProps","prototype","TasksPlugin","source","TASK_TYPE","tasks","__","taskName","path","fn","_len","_key","dispatch","name","displayName","middleware","store","action","targetComponent","nextComponent","components","getState","actions","queries"],"mappings":"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","file":"TasksPlugin.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"TasksPlugin\"] = factory();\n\telse\n\t\troot[\"relm\"] = root[\"relm\"] || {}, root[\"relm\"][\"TasksPlugin\"] = factory();\n})(this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"TasksPlugin\"] = factory();\n\telse\n\t\troot[\"relm\"] = root[\"relm\"] || {}, root[\"relm\"][\"TasksPlugin\"] = factory();\n})(this, function() {\nreturn webpackJsonprelm__name_([5],{\n\n/***/ 146:\n/***/ function(module, exports, __webpack_require__) {\n\nvar baseDifference = __webpack_require__(172),\n    baseRest = __webpack_require__(39),\n    isArrayLikeObject = __webpack_require__(116);\n\n/**\n * Creates an array excluding all given values using\n * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * for equality comparisons.\n *\n * **Note:** Unlike `_.pull`, this method returns a new array.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Array\n * @param {Array} array The array to inspect.\n * @param {...*} [values] The values to exclude.\n * @returns {Array} Returns the new array of filtered values.\n * @see _.difference, _.xor\n * @example\n *\n * _.without([2, 1, 2, 3], 1, 2);\n * // => [3]\n */\nvar without = baseRest(function(array, values) {\n  return isArrayLikeObject(array)\n    ? baseDifference(array, values)\n    : [];\n});\n\nmodule.exports = without;\n\n\n/***/ },\n\n/***/ 166:\n/***/ function(module, exports) {\n\n/**\n * This function is like `arrayIncludes` except that it accepts a comparator.\n *\n * @private\n * @param {Array} [array] The array to inspect.\n * @param {*} target The value to search for.\n * @param {Function} comparator The comparator invoked per element.\n * @returns {boolean} Returns `true` if `target` is found, else `false`.\n */\nfunction arrayIncludesWith(array, value, comparator) {\n  var index = -1,\n      length = array ? array.length : 0;\n\n  while (++index < length) {\n    if (comparator(value, array[index])) {\n      return true;\n    }\n  }\n  return false;\n}\n\nmodule.exports = arrayIncludesWith;\n\n\n/***/ },\n\n/***/ 172:\n/***/ function(module, exports, __webpack_require__) {\n\nvar SetCache = __webpack_require__(83),\n    arrayIncludes = __webpack_require__(86),\n    arrayIncludesWith = __webpack_require__(166),\n    arrayMap = __webpack_require__(88),\n    baseUnary = __webpack_require__(94),\n    cacheHas = __webpack_require__(196);\n\n/** Used as the size to enable large array optimizations. */\nvar LARGE_ARRAY_SIZE = 200;\n\n/**\n * The base implementation of methods like `_.difference` without support\n * for excluding multiple arrays or iteratee shorthands.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {Array} values The values to exclude.\n * @param {Function} [iteratee] The iteratee invoked per element.\n * @param {Function} [comparator] The comparator invoked per element.\n * @returns {Array} Returns the new array of filtered values.\n */\nfunction baseDifference(array, values, iteratee, comparator) {\n  var index = -1,\n      includes = arrayIncludes,\n      isCommon = true,\n      length = array.length,\n      result = [],\n      valuesLength = values.length;\n\n  if (!length) {\n    return result;\n  }\n  if (iteratee) {\n    values = arrayMap(values, baseUnary(iteratee));\n  }\n  if (comparator) {\n    includes = arrayIncludesWith;\n    isCommon = false;\n  }\n  else if (values.length >= LARGE_ARRAY_SIZE) {\n    includes = cacheHas;\n    isCommon = false;\n    values = new SetCache(values);\n  }\n  outer:\n  while (++index < length) {\n    var value = array[index],\n        computed = iteratee ? iteratee(value) : value;\n\n    value = (comparator || value !== 0) ? value : 0;\n    if (isCommon && computed === computed) {\n      var valuesIndex = valuesLength;\n      while (valuesIndex--) {\n        if (values[valuesIndex] === computed) {\n          continue outer;\n        }\n      }\n      result.push(value);\n    }\n    else if (!includes(values, computed, comparator)) {\n      result.push(value);\n    }\n  }\n  return result;\n}\n\nmodule.exports = baseDifference;\n\n\n/***/ },\n\n/***/ 196:\n/***/ function(module, exports) {\n\n/**\n * Checks if a cache value for `key` exists.\n *\n * @private\n * @param {Object} cache The cache to query.\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction cacheHas(cache, key) {\n  return cache.has(key);\n}\n\nmodule.exports = cacheHas;\n\n\n/***/ },\n\n/***/ 312:\n/***/ function(module, exports, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_lodash_without__ = __webpack_require__(146);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_lodash_without___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_lodash_without__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_lodash_get__ = __webpack_require__(11);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_lodash_get___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_lodash_get__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_lodash_isArray__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_lodash_isArray___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_lodash_isArray__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_lodash_mapValues__ = __webpack_require__(3);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_lodash_mapValues___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_lodash_mapValues__);\n\n/* harmony export */ __webpack_require__.d(exports, \"internals\", function() { return internals; });\n\n\n\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\nfunction _toArray(arr) { return Array.isArray(arr) ? arr : Array.from(arr); }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar TasksPlugin = function () {\n  function TasksPlugin() {\n    _classCallCheck(this, TasksPlugin);\n  }\n\n  _createClass(TasksPlugin, [{\n    key: 'apply',\n    value: function apply(component, source, root) {\n      var TASK_TYPE = '  @relm_task  ';\n\n      component.tasks = __WEBPACK_IMPORTED_MODULE_3_lodash_mapValues___default()(source.tasks, function (__, taskName) {\n        var type = [TASK_TYPE].concat(component.path, taskName);\n        var fn = function fn() {\n          for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n            args[_key] = arguments[_key];\n          }\n\n          return root.dispatch({ type: type, args: args });\n        };\n\n        Object.defineProperties(fn, {\n          name: { value: taskName },\n          displayName: { value: taskName }\n        });\n\n        return fn;\n      });\n\n      if (component !== root) return;\n\n      component.middleware = function (store) {\n        return function (next) {\n          return function (action) {\n            // Skip non-relm or non-async actions; async actions are ones where the\n            // action name (last item in type array) starts with a $ sign\n            if (!__WEBPACK_IMPORTED_MODULE_2_lodash_isArray___default()(action.type)) return next(action);\n            if (action.type[0] !== TASK_TYPE) return next(action);\n\n            // Get the path of the component\n            var path = action.type.slice(1);\n\n            // Find the component\n            var targetComponent = root;\n            for (var i = 0, n = path.length - 1; i < n; i++) {\n              var key = path[i];\n              var nextComponent = targetComponent.components[key];\n              if (!nextComponent) return null;\n              targetComponent = nextComponent;\n            }\n\n            if (!targetComponent && \"production\" !== 'production') {\n              throw new Error('Unable to find component for task ' + path);\n            }\n\n            // Create the task api\n            var task = {\n              dispatch: store.dispatch,\n              getState: path.length <= 1 ? store.getState : function () {\n                return __WEBPACK_IMPORTED_MODULE_1_lodash_get___default()(store.getState(), path.slice(0, -1));\n              },\n              actions: targetComponent.actions,\n              queries: targetComponent.queries\n            };\n\n            return handleAsyncAction(task, source, path, action.args);\n          };\n        };\n      };\n    }\n  }]);\n\n  return TasksPlugin;\n}();\n\n/* harmony default export */ exports[\"default\"] = TasksPlugin;\n\n\nfunction attachTaskAPI(task, handler) {\n  task.instances = handler.instances = handler.instances || [];\n  task.isRunning = task.instances.length > 0;\n\n  task.done = function done() {\n    handler.instances = __WEBPACK_IMPORTED_MODULE_0_lodash_without___default()(handler.instances, task);\n  };\n\n  task.cancel = function cancel() {\n    handler.instances = __WEBPACK_IMPORTED_MODULE_0_lodash_without___default()(handler.instances, task);\n    if (task.onCancel) task.onCancel();\n  };\n}\n\nfunction handleAsyncAction(task, component, type) {\n  var args = arguments.length <= 3 || arguments[3] === undefined ? [] : arguments[3];\n\n  var _type = _toArray(type);\n\n  var head = _type[0];\n\n  var tail = _type.slice(1);\n\n  var handler = __WEBPACK_IMPORTED_MODULE_1_lodash_get___default()(component, ['tasks', head]);\n  var child = __WEBPACK_IMPORTED_MODULE_1_lodash_get___default()(component, ['components', head]);\n\n  function next() {\n    for (var _len2 = arguments.length, overriddenArgs = Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n      overriddenArgs[_key2] = arguments[_key2];\n    }\n\n    handleAsyncAction(task, child, tail, overriddenArgs);\n    task.done();\n  }\n\n  // Overridden task\n  if (child && handler) {\n    attachTaskAPI(task, handler);\n\n    var result = handler.apply(undefined, [task, next].concat(_toConsumableArray(args)));\n    if (typeof result === 'function') task.onCancel = result;\n    return;\n  }\n\n  // Own task\n  if (handler) {\n    attachTaskAPI(task, handler);\n\n    var _result = handler.apply(undefined, [task].concat(_toConsumableArray(args)));\n    if (typeof _result === 'function') task.onCancel = _result;\n    return;\n  }\n\n  // Child task\n  if (child) {\n    handleAsyncAction(task, child, tail, args);\n    return;\n  }\n\n  throw new Error('Unable to find task ' + head);\n}\n\nvar internals = {\n  attachTaskAPI: attachTaskAPI,\n  handleAsyncAction: handleAsyncAction\n};\n\n/***/ }\n\n},[312])\n});\n;\n\n\n// WEBPACK FOOTER //\n// TasksPlugin.min.js","var baseDifference = require('./_baseDifference'),\n    baseRest = require('./_baseRest'),\n    isArrayLikeObject = require('./isArrayLikeObject');\n\n/**\n * Creates an array excluding all given values using\n * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * for equality comparisons.\n *\n * **Note:** Unlike `_.pull`, this method returns a new array.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Array\n * @param {Array} array The array to inspect.\n * @param {...*} [values] The values to exclude.\n * @returns {Array} Returns the new array of filtered values.\n * @see _.difference, _.xor\n * @example\n *\n * _.without([2, 1, 2, 3], 1, 2);\n * // => [3]\n */\nvar without = baseRest(function(array, values) {\n  return isArrayLikeObject(array)\n    ? baseDifference(array, values)\n    : [];\n});\n\nmodule.exports = without;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/lodash/without.js\n// module id = 146\n// module chunks = 5","/**\n * This function is like `arrayIncludes` except that it accepts a comparator.\n *\n * @private\n * @param {Array} [array] The array to inspect.\n * @param {*} target The value to search for.\n * @param {Function} comparator The comparator invoked per element.\n * @returns {boolean} Returns `true` if `target` is found, else `false`.\n */\nfunction arrayIncludesWith(array, value, comparator) {\n  var index = -1,\n      length = array ? array.length : 0;\n\n  while (++index < length) {\n    if (comparator(value, array[index])) {\n      return true;\n    }\n  }\n  return false;\n}\n\nmodule.exports = arrayIncludesWith;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/lodash/_arrayIncludesWith.js\n// module id = 166\n// module chunks = 5","var SetCache = require('./_SetCache'),\n    arrayIncludes = require('./_arrayIncludes'),\n    arrayIncludesWith = require('./_arrayIncludesWith'),\n    arrayMap = require('./_arrayMap'),\n    baseUnary = require('./_baseUnary'),\n    cacheHas = require('./_cacheHas');\n\n/** Used as the size to enable large array optimizations. */\nvar LARGE_ARRAY_SIZE = 200;\n\n/**\n * The base implementation of methods like `_.difference` without support\n * for excluding multiple arrays or iteratee shorthands.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {Array} values The values to exclude.\n * @param {Function} [iteratee] The iteratee invoked per element.\n * @param {Function} [comparator] The comparator invoked per element.\n * @returns {Array} Returns the new array of filtered values.\n */\nfunction baseDifference(array, values, iteratee, comparator) {\n  var index = -1,\n      includes = arrayIncludes,\n      isCommon = true,\n      length = array.length,\n      result = [],\n      valuesLength = values.length;\n\n  if (!length) {\n    return result;\n  }\n  if (iteratee) {\n    values = arrayMap(values, baseUnary(iteratee));\n  }\n  if (comparator) {\n    includes = arrayIncludesWith;\n    isCommon = false;\n  }\n  else if (values.length >= LARGE_ARRAY_SIZE) {\n    includes = cacheHas;\n    isCommon = false;\n    values = new SetCache(values);\n  }\n  outer:\n  while (++index < length) {\n    var value = array[index],\n        computed = iteratee ? iteratee(value) : value;\n\n    value = (comparator || value !== 0) ? value : 0;\n    if (isCommon && computed === computed) {\n      var valuesIndex = valuesLength;\n      while (valuesIndex--) {\n        if (values[valuesIndex] === computed) {\n          continue outer;\n        }\n      }\n      result.push(value);\n    }\n    else if (!includes(values, computed, comparator)) {\n      result.push(value);\n    }\n  }\n  return result;\n}\n\nmodule.exports = baseDifference;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/lodash/_baseDifference.js\n// module id = 172\n// module chunks = 5","/**\n * Checks if a cache value for `key` exists.\n *\n * @private\n * @param {Object} cache The cache to query.\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction cacheHas(cache, key) {\n  return cache.has(key);\n}\n\nmodule.exports = cacheHas;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/lodash/_cacheHas.js\n// module id = 196\n// module chunks = 5","import _ from 'lodash';\n\nexport default class TasksPlugin {\n  apply (component, source, root) {\n    const TASK_TYPE = '  @relm_task  ';\n\n    component.tasks = _.mapValues(source.tasks, (__, taskName) => {\n      const type = [TASK_TYPE].concat(component.path, taskName);\n      const fn = (...args) => root.dispatch({ type, args });\n\n      Object.defineProperties(fn, {\n        name: { value: taskName },\n        displayName: { value: taskName }\n      });\n\n      return fn;\n    });\n\n    if (component !== root) return;\n\n    component.middleware = (store) => (next) => (action) => {\n      // Skip non-relm or non-async actions; async actions are ones where the\n      // action name (last item in type array) starts with a $ sign\n      if (!_.isArray(action.type)) return next(action);\n      if (action.type[0] !== TASK_TYPE) return next(action);\n\n\n      // Get the path of the component\n      const path = action.type.slice(1);\n\n      // Find the component\n      let targetComponent = root;\n      for (let i = 0, n = path.length - 1; i < n; i++) {\n        const key = path[i];\n        const nextComponent = targetComponent.components[key];\n        if (!nextComponent) return null;\n        targetComponent = nextComponent;\n      }\n\n      if (!targetComponent && process.env.NODE_ENV !== 'production') {\n        throw new Error(`Unable to find component for task ${path}`);\n      }\n\n      // Create the task api\n      const task = {\n        dispatch: store.dispatch,\n        getState: path.length <= 1 ? store.getState : () => _.get(store.getState(), path.slice(0, -1)),\n        actions: targetComponent.actions,\n        queries: targetComponent.queries,\n      };\n\n      return handleAsyncAction(task, source, path, action.args);\n    };\n  }\n}\n\nfunction attachTaskAPI (task, handler) {\n  task.instances = handler.instances = handler.instances || [];\n  task.isRunning = task.instances.length > 0;\n\n  task.done = function done () {\n    handler.instances = _.without(handler.instances, task);\n  };\n\n  task.cancel = function cancel () {\n    handler.instances = _.without(handler.instances, task);\n    if (task.onCancel) task.onCancel();\n  };\n}\n\nfunction handleAsyncAction (task, component, type, args = []) {\n  const [head, ...tail] = type;\n  const handler = _.get(component, ['tasks', head]);\n  const child = _.get(component, ['components', head]);\n\n  function next (...overriddenArgs) {\n    handleAsyncAction(task, child, tail, overriddenArgs);\n    task.done();\n  }\n\n  // Overridden task\n  if (child && handler) {\n    attachTaskAPI(task, handler);\n\n    const result = handler(task, next, ...args);\n    if (typeof result === 'function') task.onCancel = result;\n    return;\n  }\n\n  // Own task\n  if (handler) {\n    attachTaskAPI(task, handler);\n\n    const result = handler(task, ...args);\n    if (typeof result === 'function') task.onCancel = result;\n    return;\n  }\n\n  // Child task\n  if (child) {\n    handleAsyncAction(task, child, tail, args);\n    return;\n  }\n\n  throw new Error(`Unable to find task ${head}`);\n}\n\nexport const internals = {\n  attachTaskAPI,\n  handleAsyncAction,\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/plugins/TasksPlugin.js"],"sourceRoot":""}